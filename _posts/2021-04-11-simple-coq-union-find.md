---
date: 2021-04-11
layout: post
title: A Simple, Probably-Not-Exp-Time Disjoint Set in Coq
categories:
- Formal Methods
tags:
- coq
---



<link rel="stylesheet" href="/assets/alectryon/alectryon.css" type="text/css" />
<link rel="stylesheet" href="/assets/alectryon/tango_subtle.css" type="text/css" />
<link rel="stylesheet" href="/assets/alectryon/tango_subtle.min.css" type="text/css" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/IBM-type/0.5.4/css/ibm-type.min.css" integrity="sha512-sky5cf9Ts6FY1kstGOBHSybfKqdHR41M0Ldb0BjNiv3ifltoQIsg0zIaQ+wwdwgQ0w9vKFW7Js50lxH9vqNSSw==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/firacode/5.2.0/fira_code.min.css" integrity="sha512-MbysAYimH1hH2xYzkkMHB6MqxBqfP0megxsCLknbYqHVwXTCg9IqHbk+ZP/vnhO8UEW6PaXAkKe2vQ+SWACxxA==" crossorigin="anonymous" />

<p>A data structure that I've been more and more interested in recently is the disjoint set data structure or union-find.
<a class="reference external" href="https://en.wikipedia.org/wiki/Disjoint-set_data_structure">https://en.wikipedia.org/wiki/Disjoint-set_data_structure</a> It's used in egraphs, unification, prolog, and graph connectivity.</p>
<p>I realized a cute representation that is easy to use and prove stuff about. It is however very inefficient compared to the usual version of disjoint set (outrageously so since the inverse Ackermann complexity of union find is a crown jewel of algorithms), hence the expectation lowering title of the post. It's linear time in the number of unions I believe. Oh well. It uses a simple functional representation based off the observation that the preimages of a function form disjoint sets. This representation is somewhat analogous to using functions to represent Maps in Coq like in Software Foundations. This is another inefficient but very convenient representation. <a class="reference external" href="https://softwarefoundations.cis.upenn.edu/lf-current/Maps.html">https://softwarefoundations.cis.upenn.edu/lf-current/Maps.html</a></p>
<p>The nice thing about this is that it really avoids any termination stickiness. Termination of the <code class="highlight coq"><span class="name">find_root</span></code> operation of a union find in an explicit array or tree is not at all obvious and requires side proof or a refined type.
The termination ultimately comes from the fact that you used a finite number of unions to construct the disjoint sets.</p>
Code of post here <https://gist.github.com/philzook58/82f4a22c194587e3f63904d33c0f2b3d>
### Definitions
<pre class="alectryon-io"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Require Import</span> Arith.</span></span></span></pre><p>For convenience we define disjoint sets of nats. See comments at end of post for some other options</p>
<pre class="alectryon-io"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">ds</span> := nat -&gt; nat.</span></span></span></pre><p>The completely disjoint set is the identity function</p>
<pre class="alectryon-io"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">init_ds</span> : ds := <span class="kr">fun</span> <span class="nv">x</span> =&gt; x.</span></span></span></pre><p><code class="highlight coq"><span class="name">find_root</span></code> is just application</p>
<pre class="alectryon-io"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">find_root</span> (<span class="nv">g</span> : ds) <span class="nv">x</span> := g x.</span></span></span></pre><p><code class="highlight coq"><span class="name">in_same_set</span></code> is just <code class="highlight coq"><span class="name">nat</span></code> equality checking</p>
<pre class="alectryon-io"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">in_same_set</span> (<span class="nv">g</span> : ds) <span class="nv">x</span> <span class="nv">y</span> := 
    Nat.eq_dec (g x) (g y).</span></span></span></pre><p>And finally the only interesting operation is <code class="highlight coq"><span class="name">union</span></code>. Some comments: It is useful to lift the <code class="highlight coq"><span class="name">find_root</span></code> operations out of the body of the returned function to compute them eagerly and share the result. This version unfortunately means that the cost of a <code class="highlight coq"><span class="name">find_root</span></code> operation becomes proportional to the number of <code class="highlight coq"><span class="name">union</span></code> operations used to construct the <code class="highlight coq"><span class="name">ds</span></code></p>
<pre class="alectryon-io"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">union</span> (<span class="nv">g</span> : ds) <span class="nv">x</span> <span class="nv">y</span> : ds :=
    <span class="kr">let</span> <span class="nv">px</span> := find_root g x <span class="kr">in</span>
    <span class="kr">let</span> <span class="nv">py</span> := find_root g y <span class="kr">in</span>
    <span class="kr">fun</span> <span class="nv">z</span> =&gt;
    <span class="kr">let</span> <span class="nv">pz</span> := find_root g z <span class="kr">in</span>
    <span class="kr">if</span> Nat.eq_dec px pz
    <span class="kr">then</span> py
    <span class="kr">else</span> pz.</span></span></span></pre><div class="section" id="some-proofs">
<h1>Some proofs</h1>
<p>I couldn't find this useful lemma in the standard library. Maybe I just missed it?</p>
<pre class="alectryon-io"><!-- Generator: Alectryon --><span class="alectryon-sentence"><input class="alectryon-toggle" id="unionfind-v-chk0" style="display: none" type="checkbox"><label class="alectryon-input" for="unionfind-v-chk0"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">nat_eq_refl</span> : <span class="kr">forall</span> <span class="nv">x</span>, <span class="kr">exists</span> <span class="nv">p</span>, Nat.eq_dec x x = <span class="nb">left</span> p.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : nat,
<span class="kr">exists</span> <span class="nv">p</span> : x = x, Nat.eq_dec x x = <span class="nb">left</span> p</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="unionfind-v-chk1" style="display: none" type="checkbox"><label class="alectryon-input" for="unionfind-v-chk1"><span class="highlight"><span class="nb">intros</span> x.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">exists</span> <span class="nv">p</span> : x = x, Nat.eq_dec x x = <span class="nb">left</span> p</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="unionfind-v-chk2" style="display: none" type="checkbox"><label class="alectryon-input" for="unionfind-v-chk2"><span class="highlight"><span class="nb">destruct</span> (Nat.eq_dec x x).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">x = x</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">exists</span> <span class="nv">p</span> : x = x, <span class="nb">left</span> e = <span class="nb">left</span> p</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="unionfind-v-chk3" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">x &lt;&gt; x</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="unionfind-v-chk3"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">exists</span> <span class="nv">p</span> : x = x, <span class="nb">right</span> n = <span class="nb">left</span> p</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="unionfind-v-chk4" style="display: none" type="checkbox"><label class="alectryon-input" for="unionfind-v-chk4"><span class="highlight"><span class="nb">eexists</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">x = x</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="nb">left</span> e = <span class="nb">left</span> <span class="nl">?p</span></span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="unionfind-v-chk5" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">x &lt;&gt; x</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="unionfind-v-chk5"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">exists</span> <span class="nv">p</span> : x = x, <span class="nb">right</span> n = <span class="nb">left</span> p</span></div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="unionfind-v-chk6" style="display: none" type="checkbox"><label class="alectryon-input" for="unionfind-v-chk6"><span class="highlight"><span class="bp">reflexivity</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">x &lt;&gt; x</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">exists</span> <span class="nv">p</span> : x = x, <span class="nb">right</span> n = <span class="nb">left</span> p</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="unionfind-v-chk7" style="display: none" type="checkbox"><label class="alectryon-input" for="unionfind-v-chk7"><span class="highlight"><span class="nb">unfold</span> <span class="s2">&quot;&lt;&gt;&quot;</span> <span class="kr">in</span> n.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">x = x -&gt; <span class="kt">False</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">exists</span> <span class="nv">p</span> : x = x, <span class="nb">right</span> n = <span class="nb">left</span> p</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="unionfind-v-chk8" style="display: none" type="checkbox"><label class="alectryon-input" for="unionfind-v-chk8"><span class="highlight"><span class="nb">exfalso</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">x = x -&gt; <span class="kt">False</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kt">False</span></span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="unionfind-v-chk9" style="display: none" type="checkbox"><label class="alectryon-input" for="unionfind-v-chk9"><span class="highlight"><span class="nb">apply</span> n.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">x = x -&gt; <span class="kt">False</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">x = x</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">reflexivity</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span></span></pre><p>A useful definition is <code class="highlight coq"><span class="name">In_Same_Set</span></code>, which states that two nats <code class="highlight coq"><span class="name">x</span></code> and <code class="highlight coq"><span class="name">y</span></code> are in the same set if the <code class="highlight coq"><span class="name">in_same_set</span></code> function returns a <code class="highlight coq"><span class="name builtin">left</span></code></p>
<pre class="alectryon-io"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">In_Same_Set</span> <span class="nv">g</span> <span class="nv">x</span> <span class="nv">y</span> := <span class="kr">exists</span> <span class="nv">p</span>, 
   in_same_set g x y = <span class="nb">left</span> p.</span></span></span></pre><p>An element is always in the same set with itself</p>
<pre class="alectryon-io"><!-- Generator: Alectryon --><span class="alectryon-sentence"><input class="alectryon-toggle" id="unionfind-v-chka" style="display: none" type="checkbox"><label class="alectryon-input" for="unionfind-v-chka"><span class="highlight"><span class="kn">Theorem</span> <span class="nf">disjoint_refl</span> : <span class="kr">forall</span> <span class="nv">g</span> <span class="nv">x</span>,
  In_Same_Set g x x.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">g</span> : ds) (<span class="nv">x</span> : nat), In_Same_Set g x x</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="unionfind-v-chkb" style="display: none" type="checkbox"><label class="alectryon-input" for="unionfind-v-chkb"><span class="highlight"><span class="nb">intros</span> g x.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ds</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">In_Same_Set g x x</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="unionfind-v-chkc" style="display: none" type="checkbox"><label class="alectryon-input" for="unionfind-v-chkc"><span class="highlight"><span class="nb">unfold</span> In_Same_Set, in_same_set.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ds</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">exists</span> <span class="nv">p</span> : g x = g x, Nat.eq_dec (g x) (g x) = <span class="nb">left</span> p</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="unionfind-v-chkd" style="display: none" type="checkbox"><label class="alectryon-input" for="unionfind-v-chkd"><span class="highlight"><span class="nb">destruct</span> (Nat.eq_dec (g x) (g x)).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ds</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g x = g x</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">exists</span> <span class="nv">p</span> : g x = g x, <span class="nb">left</span> e = <span class="nb">left</span> p</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="unionfind-v-chke" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ds</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g x &lt;&gt; g x</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="unionfind-v-chke"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">exists</span> <span class="nv">p</span> : g x = g x, <span class="nb">right</span> n = <span class="nb">left</span> p</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="unionfind-v-chkf" style="display: none" type="checkbox"><label class="alectryon-input" for="unionfind-v-chkf"><span class="highlight">-</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ds</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g x = g x</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">exists</span> <span class="nv">p</span> : g x = g x, <span class="nb">left</span> e = <span class="nb">left</span> p</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="unionfind-v-chk10" style="display: none" type="checkbox"><label class="alectryon-input" for="unionfind-v-chk10"><span class="highlight"><span class="nb">eexists</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ds</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g x = g x</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="nb">left</span> e = <span class="nb">left</span> <span class="nl">?p</span></span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">reflexivity</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="unionfind-v-chk11" style="display: none" type="checkbox"><label class="alectryon-input" for="unionfind-v-chk11"><span class="highlight">-</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ds</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g x &lt;&gt; g x</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">exists</span> <span class="nv">p</span> : g x = g x, <span class="nb">right</span> n = <span class="nb">left</span> p</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="unionfind-v-chk12" style="display: none" type="checkbox"><label class="alectryon-input" for="unionfind-v-chk12"><span class="highlight"><span class="nb">exfalso</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ds</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g x &lt;&gt; g x</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kt">False</span></span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="unionfind-v-chk13" style="display: none" type="checkbox"><label class="alectryon-input" for="unionfind-v-chk13"><span class="highlight"><span class="nb">apply</span> n.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ds</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g x &lt;&gt; g x</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">g x = g x</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">reflexivity</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span></span></pre><p>The <code class="highlight coq"><span class="name">In_Same_Set</span> <span class="name">g</span></code> relation is symmettric.</p>
<pre class="alectryon-io"><!-- Generator: Alectryon --><span class="alectryon-sentence"><input class="alectryon-toggle" id="unionfind-v-chk14" style="display: none" type="checkbox"><label class="alectryon-input" for="unionfind-v-chk14"><span class="highlight"><span class="kn">Theorem</span> <span class="nf">disjoint_sym</span> : <span class="kr">forall</span> <span class="nv">g</span> <span class="nv">x</span> <span class="nv">y</span>,
  In_Same_Set g x y -&gt; 
  In_Same_Set g y x.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">g</span> : ds) (<span class="nv">x</span> <span class="nv">y</span> : nat),
In_Same_Set g x y -&gt; In_Same_Set g y x</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="unionfind-v-chk15" style="display: none" type="checkbox"><label class="alectryon-input" for="unionfind-v-chk15"><span class="highlight"><span class="nb">unfold</span> In_Same_Set, in_same_set, find_root.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">g</span> : ds) (<span class="nv">x</span> <span class="nv">y</span> : nat),
(<span class="kr">exists</span> <span class="nv">p</span> : g x = g y, Nat.eq_dec (g x) (g y) = <span class="nb">left</span> p) -&gt;
<span class="kr">exists</span> <span class="nv">p</span> : g y = g x, Nat.eq_dec (g y) (g x) = <span class="nb">left</span> p</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="unionfind-v-chk16" style="display: none" type="checkbox"><label class="alectryon-input" for="unionfind-v-chk16"><span class="highlight"><span class="nb">intros</span> g x y H.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ds</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">exists</span> <span class="nv">p</span> : g x = g y,
  Nat.eq_dec (g x) (g y) = <span class="nb">left</span> p</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">exists</span> <span class="nv">p</span> : g y = g x, Nat.eq_dec (g y) (g x) = <span class="nb">left</span> p</span></div></blockquote></div></div></small><span class="alectryon-wsp"> 
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="unionfind-v-chk17" style="display: none" type="checkbox"><label class="alectryon-input" for="unionfind-v-chk17"><span class="highlight"><span class="nb">destruct</span> H.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ds</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g x = g y</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Nat.eq_dec (g x) (g y) = <span class="nb">left</span> x0</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">exists</span> <span class="nv">p</span> : g y = g x, Nat.eq_dec (g y) (g x) = <span class="nb">left</span> p</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="unionfind-v-chk18" style="display: none" type="checkbox"><label class="alectryon-input" for="unionfind-v-chk18"><span class="highlight"><span class="nb">destruct</span> (Nat.eq_dec (g y) (g x)) <span class="nb">eqn</span>:E.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ds</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g x = g y</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Nat.eq_dec (g x) (g y) = <span class="nb">left</span> x0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g y = g x</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">E</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Nat.eq_dec (g y) (g x) = <span class="nb">left</span> e</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">exists</span> <span class="nv">p</span> : g y = g x, <span class="nb">left</span> e = <span class="nb">left</span> p</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="unionfind-v-chk19" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ds</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g x = g y</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Nat.eq_dec (g x) (g y) = <span class="nb">left</span> x0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g y &lt;&gt; g x</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">E</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Nat.eq_dec (g y) (g x) = <span class="nb">right</span> n</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="unionfind-v-chk19"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">exists</span> <span class="nv">p</span> : g y = g x, <span class="nb">right</span> n = <span class="nb">left</span> p</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="unionfind-v-chk1a" style="display: none" type="checkbox"><label class="alectryon-input" for="unionfind-v-chk1a"><span class="highlight">-</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ds</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g x = g y</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Nat.eq_dec (g x) (g y) = <span class="nb">left</span> x0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g y = g x</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">E</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Nat.eq_dec (g y) (g x) = <span class="nb">left</span> e</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">exists</span> <span class="nv">p</span> : g y = g x, <span class="nb">left</span> e = <span class="nb">left</span> p</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="unionfind-v-chk1b" style="display: none" type="checkbox"><label class="alectryon-input" for="unionfind-v-chk1b"><span class="highlight"><span class="nb">eexists</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ds</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g x = g y</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Nat.eq_dec (g x) (g y) = <span class="nb">left</span> x0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g y = g x</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">E</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Nat.eq_dec (g y) (g x) = <span class="nb">left</span> e</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="nb">left</span> e = <span class="nb">left</span> <span class="nl">?p</span></span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">reflexivity</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="unionfind-v-chk1c" style="display: none" type="checkbox"><label class="alectryon-input" for="unionfind-v-chk1c"><span class="highlight">-</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ds</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g x = g y</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Nat.eq_dec (g x) (g y) = <span class="nb">left</span> x0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g y &lt;&gt; g x</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">E</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Nat.eq_dec (g y) (g x) = <span class="nb">right</span> n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">exists</span> <span class="nv">p</span> : g y = g x, <span class="nb">right</span> n = <span class="nb">left</span> p</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="unionfind-v-chk1d" style="display: none" type="checkbox"><label class="alectryon-input" for="unionfind-v-chk1d"><span class="highlight"><span class="nb">exfalso</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ds</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g x = g y</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Nat.eq_dec (g x) (g y) = <span class="nb">left</span> x0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g y &lt;&gt; g x</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">E</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Nat.eq_dec (g y) (g x) = <span class="nb">right</span> n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kt">False</span></span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="unionfind-v-chk1e" style="display: none" type="checkbox"><label class="alectryon-input" for="unionfind-v-chk1e"><span class="highlight"><span class="nb">apply</span> n.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ds</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g x = g y</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Nat.eq_dec (g x) (g y) = <span class="nb">left</span> x0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g y &lt;&gt; g x</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">E</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Nat.eq_dec (g y) (g x) = <span class="nb">right</span> n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">g y = g x</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="unionfind-v-chk1f" style="display: none" type="checkbox"><label class="alectryon-input" for="unionfind-v-chk1f"><span class="highlight"><span class="nb">rewrite</span> x0.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ds</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g x = g y</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Nat.eq_dec (g x) (g y) = <span class="nb">left</span> x0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g y &lt;&gt; g x</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">E</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Nat.eq_dec (g y) (g x) = <span class="nb">right</span> n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">g y = g y</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">reflexivity</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp"> </span></span></pre><p>The <code class="highlight coq"><span class="name">In_Same_Set</span> <span class="name">g</span></code> relation is transtive.</p>
<pre class="alectryon-io"><!-- Generator: Alectryon --><span class="alectryon-sentence"><input class="alectryon-toggle" id="unionfind-v-chk20" style="display: none" type="checkbox"><label class="alectryon-input" for="unionfind-v-chk20"><span class="highlight"><span class="kn">Theorem</span> <span class="nf">disjoint_trans</span> : <span class="kr">forall</span> <span class="nv">g</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span>,
  In_Same_Set g x y -&gt; 
  In_Same_Set g y z -&gt;
  In_Same_Set g x z.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">g</span> : ds) (<span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span> : nat),
In_Same_Set g x y -&gt;
In_Same_Set g y z -&gt; In_Same_Set g x z</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="unionfind-v-chk21" style="display: none" type="checkbox"><label class="alectryon-input" for="unionfind-v-chk21"><span class="highlight"><span class="nb">unfold</span> In_Same_Set, in_same_set, find_root.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">g</span> : ds) (<span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span> : nat),
(<span class="kr">exists</span> <span class="nv">p</span> : g x = g y, Nat.eq_dec (g x) (g y) = <span class="nb">left</span> p) -&gt;
(<span class="kr">exists</span> <span class="nv">p</span> : g y = g z, Nat.eq_dec (g y) (g z) = <span class="nb">left</span> p) -&gt;
<span class="kr">exists</span> <span class="nv">p</span> : g x = g z, Nat.eq_dec (g x) (g z) = <span class="nb">left</span> p</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="unionfind-v-chk22" style="display: none" type="checkbox"><label class="alectryon-input" for="unionfind-v-chk22"><span class="highlight"><span class="nb">intros</span> g x y z H H0.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ds</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y, z</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">exists</span> <span class="nv">p</span> : g x = g y,
  Nat.eq_dec (g x) (g y) = <span class="nb">left</span> p</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">exists</span> <span class="nv">p</span> : g y = g z,
  Nat.eq_dec (g y) (g z) = <span class="nb">left</span> p</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">exists</span> <span class="nv">p</span> : g x = g z, Nat.eq_dec (g x) (g z) = <span class="nb">left</span> p</span></div></blockquote></div></div></small><span class="alectryon-wsp"> 
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="unionfind-v-chk23" style="display: none" type="checkbox"><label class="alectryon-input" for="unionfind-v-chk23"><span class="highlight"><span class="nb">destruct</span> H.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ds</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y, z</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g x = g y</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Nat.eq_dec (g x) (g y) = <span class="nb">left</span> x0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">exists</span> <span class="nv">p</span> : g y = g z,
  Nat.eq_dec (g y) (g z) = <span class="nb">left</span> p</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">exists</span> <span class="nv">p</span> : g x = g z, Nat.eq_dec (g x) (g z) = <span class="nb">left</span> p</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="unionfind-v-chk24" style="display: none" type="checkbox"><label class="alectryon-input" for="unionfind-v-chk24"><span class="highlight"><span class="nb">destruct</span> H0.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ds</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y, z</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g x = g y</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Nat.eq_dec (g x) (g y) = <span class="nb">left</span> x0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g y = g z</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Nat.eq_dec (g y) (g z) = <span class="nb">left</span> x1</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">exists</span> <span class="nv">p</span> : g x = g z, Nat.eq_dec (g x) (g z) = <span class="nb">left</span> p</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="unionfind-v-chk25" style="display: none" type="checkbox"><label class="alectryon-input" for="unionfind-v-chk25"><span class="highlight"><span class="nb">destruct</span> (Nat.eq_dec (g x) (g z)) <span class="nb">eqn</span>:E.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ds</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y, z</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g x = g y</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Nat.eq_dec (g x) (g y) = <span class="nb">left</span> x0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g y = g z</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Nat.eq_dec (g y) (g z) = <span class="nb">left</span> x1</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g x = g z</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">E</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Nat.eq_dec (g x) (g z) = <span class="nb">left</span> e</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">exists</span> <span class="nv">p</span> : g x = g z, <span class="nb">left</span> e = <span class="nb">left</span> p</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="unionfind-v-chk26" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ds</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y, z</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g x = g y</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Nat.eq_dec (g x) (g y) = <span class="nb">left</span> x0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g y = g z</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Nat.eq_dec (g y) (g z) = <span class="nb">left</span> x1</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g x &lt;&gt; g z</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">E</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Nat.eq_dec (g x) (g z) = <span class="nb">right</span> n</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="unionfind-v-chk26"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">exists</span> <span class="nv">p</span> : g x = g z, <span class="nb">right</span> n = <span class="nb">left</span> p</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="unionfind-v-chk27" style="display: none" type="checkbox"><label class="alectryon-input" for="unionfind-v-chk27"><span class="highlight">-</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ds</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y, z</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g x = g y</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Nat.eq_dec (g x) (g y) = <span class="nb">left</span> x0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g y = g z</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Nat.eq_dec (g y) (g z) = <span class="nb">left</span> x1</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g x = g z</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">E</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Nat.eq_dec (g x) (g z) = <span class="nb">left</span> e</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">exists</span> <span class="nv">p</span> : g x = g z, <span class="nb">left</span> e = <span class="nb">left</span> p</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="unionfind-v-chk28" style="display: none" type="checkbox"><label class="alectryon-input" for="unionfind-v-chk28"><span class="highlight"><span class="nb">eexists</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ds</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y, z</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g x = g y</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Nat.eq_dec (g x) (g y) = <span class="nb">left</span> x0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g y = g z</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Nat.eq_dec (g y) (g z) = <span class="nb">left</span> x1</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g x = g z</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">E</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Nat.eq_dec (g x) (g z) = <span class="nb">left</span> e</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="nb">left</span> e = <span class="nb">left</span> <span class="nl">?p</span></span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">reflexivity</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="unionfind-v-chk29" style="display: none" type="checkbox"><label class="alectryon-input" for="unionfind-v-chk29"><span class="highlight">-</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ds</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y, z</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g x = g y</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Nat.eq_dec (g x) (g y) = <span class="nb">left</span> x0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g y = g z</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Nat.eq_dec (g y) (g z) = <span class="nb">left</span> x1</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g x &lt;&gt; g z</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">E</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Nat.eq_dec (g x) (g z) = <span class="nb">right</span> n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">exists</span> <span class="nv">p</span> : g x = g z, <span class="nb">right</span> n = <span class="nb">left</span> p</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="unionfind-v-chk2a" style="display: none" type="checkbox"><label class="alectryon-input" for="unionfind-v-chk2a"><span class="highlight"><span class="nb">exfalso</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ds</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y, z</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g x = g y</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Nat.eq_dec (g x) (g y) = <span class="nb">left</span> x0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g y = g z</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Nat.eq_dec (g y) (g z) = <span class="nb">left</span> x1</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g x &lt;&gt; g z</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">E</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Nat.eq_dec (g x) (g z) = <span class="nb">right</span> n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kt">False</span></span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="unionfind-v-chk2b" style="display: none" type="checkbox"><label class="alectryon-input" for="unionfind-v-chk2b"><span class="highlight"><span class="nb">apply</span> n.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ds</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y, z</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g x = g y</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Nat.eq_dec (g x) (g y) = <span class="nb">left</span> x0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g y = g z</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Nat.eq_dec (g y) (g z) = <span class="nb">left</span> x1</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g x &lt;&gt; g z</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">E</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Nat.eq_dec (g x) (g z) = <span class="nb">right</span> n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">g x = g z</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="unionfind-v-chk2c" style="display: none" type="checkbox"><label class="alectryon-input" for="unionfind-v-chk2c"><span class="highlight"><span class="nb">rewrite</span> x0.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ds</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y, z</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g x = g y</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Nat.eq_dec (g x) (g y) = <span class="nb">left</span> x0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g y = g z</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Nat.eq_dec (g y) (g z) = <span class="nb">left</span> x1</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g x &lt;&gt; g z</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">E</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Nat.eq_dec (g x) (g z) = <span class="nb">right</span> n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">g y = g z</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="unionfind-v-chk2d" style="display: none" type="checkbox"><label class="alectryon-input" for="unionfind-v-chk2d"><span class="highlight"><span class="nb">rewrite</span> x1.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ds</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y, z</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g x = g y</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Nat.eq_dec (g x) (g y) = <span class="nb">left</span> x0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g y = g z</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Nat.eq_dec (g y) (g z) = <span class="nb">left</span> x1</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g x &lt;&gt; g z</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">E</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Nat.eq_dec (g x) (g z) = <span class="nb">right</span> n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">g z = g z</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">reflexivity</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span></span></pre><p>The initial disjoint set only has equal elements in the same set</p>
<pre class="alectryon-io"><!-- Generator: Alectryon --><span class="alectryon-sentence"><input class="alectryon-toggle" id="unionfind-v-chk2e" style="display: none" type="checkbox"><label class="alectryon-input" for="unionfind-v-chk2e"><span class="highlight"><span class="kn">Theorem</span> <span class="nf">disjoint_init</span> : <span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span>, x &lt;&gt; y -&gt;
   <span class="kr">exists</span> <span class="nv">p</span>, in_same_set init_ds x y = <span class="nb">right</span> p.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : nat,
x &lt;&gt; y -&gt;
<span class="kr">exists</span> <span class="nv">p</span> : init_ds x &lt;&gt; init_ds y,
  in_same_set init_ds x y = <span class="nb">right</span> p</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">   </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="unionfind-v-chk2f" style="display: none" type="checkbox"><label class="alectryon-input" for="unionfind-v-chk2f"><span class="highlight"><span class="nb">intros</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">x &lt;&gt; y</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">exists</span> <span class="nv">p</span> : init_ds x &lt;&gt; init_ds y,
  in_same_set init_ds x y = <span class="nb">right</span> p</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">   </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="unionfind-v-chk30" style="display: none" type="checkbox"><label class="alectryon-input" for="unionfind-v-chk30"><span class="highlight"><span class="nb">destruct</span> in_same_set.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">x &lt;&gt; y</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">init_ds x = init_ds y</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">exists</span> <span class="nv">p</span> : init_ds x &lt;&gt; init_ds y, <span class="nb">left</span> e = <span class="nb">right</span> p</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="unionfind-v-chk31" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">x &lt;&gt; y</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">init_ds x &lt;&gt; init_ds y</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="unionfind-v-chk31"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">exists</span> <span class="nv">p</span> : init_ds x &lt;&gt; init_ds y, <span class="nb">right</span> n = <span class="nb">right</span> p</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">   </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="unionfind-v-chk32" style="display: none" type="checkbox"><label class="alectryon-input" for="unionfind-v-chk32"><span class="highlight"><span class="nb">exfalso</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">x &lt;&gt; y</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">init_ds x = init_ds y</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kt">False</span></span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="unionfind-v-chk33" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">x &lt;&gt; y</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">init_ds x &lt;&gt; init_ds y</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="unionfind-v-chk33"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">exists</span> <span class="nv">p</span> : init_ds x &lt;&gt; init_ds y, <span class="nb">right</span> n = <span class="nb">right</span> p</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">   </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="unionfind-v-chk34" style="display: none" type="checkbox"><label class="alectryon-input" for="unionfind-v-chk34"><span class="highlight"><span class="nb">apply</span> H.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">x &lt;&gt; y</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">init_ds x = init_ds y</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">x = y</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="unionfind-v-chk35" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">x &lt;&gt; y</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">init_ds x &lt;&gt; init_ds y</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="unionfind-v-chk35"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">exists</span> <span class="nv">p</span> : init_ds x &lt;&gt; init_ds y, <span class="nb">right</span> n = <span class="nb">right</span> p</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">   </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="unionfind-v-chk36" style="display: none" type="checkbox"><label class="alectryon-input" for="unionfind-v-chk36"><span class="highlight"><span class="nb">unfold</span> init_ds <span class="kr">in</span> e.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">x &lt;&gt; y</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">x = y</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">x = y</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="unionfind-v-chk37" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">x &lt;&gt; y</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">init_ds x &lt;&gt; init_ds y</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="unionfind-v-chk37"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">exists</span> <span class="nv">p</span> : init_ds x &lt;&gt; init_ds y, <span class="nb">right</span> n = <span class="nb">right</span> p</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">   </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="unionfind-v-chk38" style="display: none" type="checkbox"><label class="alectryon-input" for="unionfind-v-chk38"><span class="highlight"><span class="nb">apply</span> e.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">x &lt;&gt; y</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">init_ds x &lt;&gt; init_ds y</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">exists</span> <span class="nv">p</span> : init_ds x &lt;&gt; init_ds y, <span class="nb">right</span> n = <span class="nb">right</span> p</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">   </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="unionfind-v-chk39" style="display: none" type="checkbox"><label class="alectryon-input" for="unionfind-v-chk39"><span class="highlight"><span class="nb">eexists</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">x &lt;&gt; y</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">init_ds x &lt;&gt; init_ds y</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="nb">right</span> n = <span class="nb">right</span> <span class="nl">?p</span></span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">reflexivity</span>.</span></span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span></span></pre><p>After unioning x and y, they are now in the same set. This proof could be tightened up and automated more.</p>
<pre class="alectryon-io"><!-- Generator: Alectryon --><span class="alectryon-sentence"><input class="alectryon-toggle" id="unionfind-v-chk3a" style="display: none" type="checkbox"><label class="alectryon-input" for="unionfind-v-chk3a"><span class="highlight"><span class="kn">Theorem</span> <span class="nf">union_works</span> : <span class="kr">forall</span> <span class="nv">g</span> <span class="nv">x</span> <span class="nv">y</span>, 
  In_Same_Set (union g x y) x y.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">g</span> : ds) (<span class="nv">x</span> <span class="nv">y</span> : nat),
In_Same_Set (union g x y) x y</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="unionfind-v-chk3b" style="display: none" type="checkbox"><label class="alectryon-input" for="unionfind-v-chk3b"><span class="highlight"><span class="nb">intros</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ds</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">In_Same_Set (union g x y) x y</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="unionfind-v-chk3c" style="display: none" type="checkbox"><label class="alectryon-input" for="unionfind-v-chk3c"><span class="highlight"><span class="nb">unfold</span> In_Same_Set, in_same_set, union, find_root.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ds</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">exists</span>
  <span class="nv">p</span> : (<span class="kr">if</span> Nat.eq_dec (g x) (g x) <span class="kr">then</span> g y <span class="kr">else</span> g x) =
      (<span class="kr">if</span> Nat.eq_dec (g x) (g y) <span class="kr">then</span> g y <span class="kr">else</span> g y),
  Nat.eq_dec
    (<span class="kr">if</span> Nat.eq_dec (g x) (g x) <span class="kr">then</span> g y <span class="kr">else</span> g x)
    (<span class="kr">if</span> Nat.eq_dec (g x) (g y) <span class="kr">then</span> g y <span class="kr">else</span> g y) =
  <span class="nb">left</span> p</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="unionfind-v-chk3d" style="display: none" type="checkbox"><label class="alectryon-input" for="unionfind-v-chk3d"><span class="highlight"><span class="nb">destruct</span> (Nat.eq_dec (g x) (g y)) <span class="nb">eqn</span>:E1;
  <span class="nb">destruct</span> (Nat.eq_dec (g x) (g x)) <span class="nb">eqn</span>:E2;
  <span class="nb">destruct</span> (Nat.eq_dec (g y) (g y)) <span class="nb">eqn</span>:E3.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ds</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g x = g y</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">E1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Nat.eq_dec (g x) (g y) = <span class="nb">left</span> e</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g x = g x</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">E2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Nat.eq_dec (g x) (g x) = <span class="nb">left</span> e0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g y = g y</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">E3</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Nat.eq_dec (g y) (g y) = <span class="nb">left</span> e1</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">exists</span> <span class="nv">p</span> : g y = g y, <span class="nb">left</span> e1 = <span class="nb">left</span> p</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="unionfind-v-chk3e" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ds</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g x = g y</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">E1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Nat.eq_dec (g x) (g y) = <span class="nb">left</span> e</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g x = g x</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">E2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Nat.eq_dec (g x) (g x) = <span class="nb">left</span> e0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g y &lt;&gt; g y</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">E3</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Nat.eq_dec (g y) (g y) = <span class="nb">right</span> n</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="unionfind-v-chk3e"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">exists</span> <span class="nv">p</span> : g y = g y, <span class="nb">right</span> n = <span class="nb">left</span> p</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="unionfind-v-chk3f" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ds</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g x = g y</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">E1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Nat.eq_dec (g x) (g y) = <span class="nb">left</span> e</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g x &lt;&gt; g x</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">E2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Nat.eq_dec (g x) (g x) = <span class="nb">right</span> n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g y = g y</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">E3</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Nat.eq_dec (g y) (g y) = <span class="nb">left</span> e0</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="unionfind-v-chk3f"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">exists</span> <span class="nv">p</span> : g x = g y, Nat.eq_dec (g x) (g y) = <span class="nb">left</span> p</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="unionfind-v-chk40" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ds</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g x = g y</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">E1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Nat.eq_dec (g x) (g y) = <span class="nb">left</span> e</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g x &lt;&gt; g x</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">E2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Nat.eq_dec (g x) (g x) = <span class="nb">right</span> n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g y &lt;&gt; g y</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">E3</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Nat.eq_dec (g y) (g y) = <span class="nb">right</span> n0</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="unionfind-v-chk40"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">exists</span> <span class="nv">p</span> : g x = g y, Nat.eq_dec (g x) (g y) = <span class="nb">left</span> p</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="unionfind-v-chk41" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ds</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g x &lt;&gt; g y</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">E1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Nat.eq_dec (g x) (g y) = <span class="nb">right</span> n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g x = g x</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">E2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Nat.eq_dec (g x) (g x) = <span class="nb">left</span> e</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g y = g y</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">E3</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Nat.eq_dec (g y) (g y) = <span class="nb">left</span> e0</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="unionfind-v-chk41"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">exists</span> <span class="nv">p</span> : g y = g y, <span class="nb">left</span> e0 = <span class="nb">left</span> p</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="unionfind-v-chk42" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ds</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g x &lt;&gt; g y</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">E1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Nat.eq_dec (g x) (g y) = <span class="nb">right</span> n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g x = g x</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">E2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Nat.eq_dec (g x) (g x) = <span class="nb">left</span> e</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g y &lt;&gt; g y</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">E3</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Nat.eq_dec (g y) (g y) = <span class="nb">right</span> n0</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="unionfind-v-chk42"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">exists</span> <span class="nv">p</span> : g y = g y, <span class="nb">right</span> n0 = <span class="nb">left</span> p</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="unionfind-v-chk43" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ds</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g x &lt;&gt; g y</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">E1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Nat.eq_dec (g x) (g y) = <span class="nb">right</span> n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g x &lt;&gt; g x</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">E2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Nat.eq_dec (g x) (g x) = <span class="nb">right</span> n0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g y = g y</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">E3</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Nat.eq_dec (g y) (g y) = <span class="nb">left</span> e</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="unionfind-v-chk43"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">exists</span> <span class="nv">p</span> : g x = g y, Nat.eq_dec (g x) (g y) = <span class="nb">left</span> p</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="unionfind-v-chk44" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ds</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g x &lt;&gt; g y</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">E1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Nat.eq_dec (g x) (g y) = <span class="nb">right</span> n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g x &lt;&gt; g x</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">E2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Nat.eq_dec (g x) (g x) = <span class="nb">right</span> n0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g y &lt;&gt; g y</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">E3</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Nat.eq_dec (g y) (g y) = <span class="nb">right</span> n1</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="unionfind-v-chk44"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">exists</span> <span class="nv">p</span> : g x = g y, Nat.eq_dec (g x) (g y) = <span class="nb">left</span> p</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="unionfind-v-chk45" style="display: none" type="checkbox"><label class="alectryon-input" for="unionfind-v-chk45"><span class="highlight">-</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ds</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g x = g y</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">E1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Nat.eq_dec (g x) (g y) = <span class="nb">left</span> e</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g x = g x</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">E2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Nat.eq_dec (g x) (g x) = <span class="nb">left</span> e0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g y = g y</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">E3</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Nat.eq_dec (g y) (g y) = <span class="nb">left</span> e1</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">exists</span> <span class="nv">p</span> : g y = g y, <span class="nb">left</span> e1 = <span class="nb">left</span> p</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="unionfind-v-chk46" style="display: none" type="checkbox"><label class="alectryon-input" for="unionfind-v-chk46"><span class="highlight"><span class="nb">eexists</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ds</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g x = g y</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">E1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Nat.eq_dec (g x) (g y) = <span class="nb">left</span> e</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g x = g x</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">E2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Nat.eq_dec (g x) (g x) = <span class="nb">left</span> e0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g y = g y</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">E3</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Nat.eq_dec (g y) (g y) = <span class="nb">left</span> e1</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="nb">left</span> e1 = <span class="nb">left</span> <span class="nl">?p</span></span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">reflexivity</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="unionfind-v-chk47" style="display: none" type="checkbox"><label class="alectryon-input" for="unionfind-v-chk47"><span class="highlight">-</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ds</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g x = g y</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">E1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Nat.eq_dec (g x) (g y) = <span class="nb">left</span> e</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g x = g x</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">E2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Nat.eq_dec (g x) (g x) = <span class="nb">left</span> e0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g y &lt;&gt; g y</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">E3</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Nat.eq_dec (g y) (g y) = <span class="nb">right</span> n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">exists</span> <span class="nv">p</span> : g y = g y, <span class="nb">right</span> n = <span class="nb">left</span> p</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="unionfind-v-chk48" style="display: none" type="checkbox"><label class="alectryon-input" for="unionfind-v-chk48"><span class="highlight"><span class="nb">exfalso</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ds</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g x = g y</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">E1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Nat.eq_dec (g x) (g y) = <span class="nb">left</span> e</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g x = g x</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">E2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Nat.eq_dec (g x) (g x) = <span class="nb">left</span> e0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g y &lt;&gt; g y</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">E3</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Nat.eq_dec (g y) (g y) = <span class="nb">right</span> n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kt">False</span></span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">auto</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="unionfind-v-chk49" style="display: none" type="checkbox"><label class="alectryon-input" for="unionfind-v-chk49"><span class="highlight">-</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ds</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g x = g y</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">E1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Nat.eq_dec (g x) (g y) = <span class="nb">left</span> e</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g x &lt;&gt; g x</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">E2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Nat.eq_dec (g x) (g x) = <span class="nb">right</span> n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g y = g y</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">E3</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Nat.eq_dec (g y) (g y) = <span class="nb">left</span> e0</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">exists</span> <span class="nv">p</span> : g x = g y, Nat.eq_dec (g x) (g y) = <span class="nb">left</span> p</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">firstorder</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="unionfind-v-chk4a" style="display: none" type="checkbox"><label class="alectryon-input" for="unionfind-v-chk4a"><span class="highlight">-</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ds</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g x = g y</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">E1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Nat.eq_dec (g x) (g y) = <span class="nb">left</span> e</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g x &lt;&gt; g x</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">E2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Nat.eq_dec (g x) (g x) = <span class="nb">right</span> n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g y &lt;&gt; g y</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">E3</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Nat.eq_dec (g y) (g y) = <span class="nb">right</span> n0</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">exists</span> <span class="nv">p</span> : g x = g y, Nat.eq_dec (g x) (g y) = <span class="nb">left</span> p</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">firstorder</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="unionfind-v-chk4b" style="display: none" type="checkbox"><label class="alectryon-input" for="unionfind-v-chk4b"><span class="highlight">-</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ds</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g x &lt;&gt; g y</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">E1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Nat.eq_dec (g x) (g y) = <span class="nb">right</span> n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g x = g x</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">E2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Nat.eq_dec (g x) (g x) = <span class="nb">left</span> e</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g y = g y</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">E3</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Nat.eq_dec (g y) (g y) = <span class="nb">left</span> e0</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">exists</span> <span class="nv">p</span> : g y = g y, <span class="nb">left</span> e0 = <span class="nb">left</span> p</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="unionfind-v-chk4c" style="display: none" type="checkbox"><label class="alectryon-input" for="unionfind-v-chk4c"><span class="highlight"><span class="nb">eexists</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ds</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g x &lt;&gt; g y</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">E1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Nat.eq_dec (g x) (g y) = <span class="nb">right</span> n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g x = g x</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">E2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Nat.eq_dec (g x) (g x) = <span class="nb">left</span> e</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g y = g y</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">E3</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Nat.eq_dec (g y) (g y) = <span class="nb">left</span> e0</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="nb">left</span> e0 = <span class="nb">left</span> <span class="nl">?p</span></span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">reflexivity</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="unionfind-v-chk4d" style="display: none" type="checkbox"><label class="alectryon-input" for="unionfind-v-chk4d"><span class="highlight">-</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ds</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g x &lt;&gt; g y</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">E1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Nat.eq_dec (g x) (g y) = <span class="nb">right</span> n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g x = g x</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">E2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Nat.eq_dec (g x) (g x) = <span class="nb">left</span> e</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g y &lt;&gt; g y</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">E3</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Nat.eq_dec (g y) (g y) = <span class="nb">right</span> n0</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">exists</span> <span class="nv">p</span> : g y = g y, <span class="nb">right</span> n0 = <span class="nb">left</span> p</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="unionfind-v-chk4e" style="display: none" type="checkbox"><label class="alectryon-input" for="unionfind-v-chk4e"><span class="highlight"><span class="nb">exfalso</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ds</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g x &lt;&gt; g y</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">E1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Nat.eq_dec (g x) (g y) = <span class="nb">right</span> n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g x = g x</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">E2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Nat.eq_dec (g x) (g x) = <span class="nb">left</span> e</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g y &lt;&gt; g y</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">E3</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Nat.eq_dec (g y) (g y) = <span class="nb">right</span> n0</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kt">False</span></span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">auto</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="unionfind-v-chk4f" style="display: none" type="checkbox"><label class="alectryon-input" for="unionfind-v-chk4f"><span class="highlight">-</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ds</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g x &lt;&gt; g y</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">E1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Nat.eq_dec (g x) (g y) = <span class="nb">right</span> n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g x &lt;&gt; g x</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">E2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Nat.eq_dec (g x) (g x) = <span class="nb">right</span> n0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g y = g y</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">E3</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Nat.eq_dec (g y) (g y) = <span class="nb">left</span> e</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">exists</span> <span class="nv">p</span> : g x = g y, Nat.eq_dec (g x) (g y) = <span class="nb">left</span> p</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="unionfind-v-chk50" style="display: none" type="checkbox"><label class="alectryon-input" for="unionfind-v-chk50"><span class="highlight"><span class="nb">exfalso</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ds</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g x &lt;&gt; g y</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">E1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Nat.eq_dec (g x) (g y) = <span class="nb">right</span> n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g x &lt;&gt; g x</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">E2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Nat.eq_dec (g x) (g x) = <span class="nb">right</span> n0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g y = g y</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">E3</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Nat.eq_dec (g y) (g y) = <span class="nb">left</span> e</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kt">False</span></span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">auto</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="unionfind-v-chk51" style="display: none" type="checkbox"><label class="alectryon-input" for="unionfind-v-chk51"><span class="highlight">-</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ds</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g x &lt;&gt; g y</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">E1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Nat.eq_dec (g x) (g y) = <span class="nb">right</span> n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g x &lt;&gt; g x</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">E2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Nat.eq_dec (g x) (g x) = <span class="nb">right</span> n0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g y &lt;&gt; g y</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">E3</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Nat.eq_dec (g y) (g y) = <span class="nb">right</span> n1</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">exists</span> <span class="nv">p</span> : g x = g y, Nat.eq_dec (g x) (g y) = <span class="nb">left</span> p</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="unionfind-v-chk52" style="display: none" type="checkbox"><label class="alectryon-input" for="unionfind-v-chk52"><span class="highlight"><span class="nb">exfalso</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ds</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g x &lt;&gt; g y</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">E1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Nat.eq_dec (g x) (g y) = <span class="nb">right</span> n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g x &lt;&gt; g x</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">E2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Nat.eq_dec (g x) (g x) = <span class="nb">right</span> n0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g y &lt;&gt; g y</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">E3</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Nat.eq_dec (g y) (g y) = <span class="nb">right</span> n1</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kt">False</span></span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">auto</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span></span></pre><p>Things remain in the same set after unioning any other elements</p>
<pre class="alectryon-io"><!-- Generator: Alectryon --><span class="alectryon-sentence"><input class="alectryon-toggle" id="unionfind-v-chk53" style="display: none" type="checkbox"><label class="alectryon-input" for="unionfind-v-chk53"><span class="highlight"><span class="kn">Theorem</span> <span class="nf">union_mono</span> : <span class="kr">forall</span> <span class="nv">g</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span> <span class="nv">w</span>,
   In_Same_Set g x y -&gt;
   In_Same_Set (union g z w) x y.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">g</span> : ds) (<span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span> <span class="nv">w</span> : nat),
In_Same_Set g x y -&gt; In_Same_Set (union g z w) x y</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">   </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="unionfind-v-chk54" style="display: none" type="checkbox"><label class="alectryon-input" for="unionfind-v-chk54"><span class="highlight"><span class="nb">intros</span> g x y z w H.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ds</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y, z, w</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">In_Same_Set g x y</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">In_Same_Set (union g z w) x y</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">   </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="unionfind-v-chk55" style="display: none" type="checkbox"><label class="alectryon-input" for="unionfind-v-chk55"><span class="highlight"><span class="nb">destruct</span> H.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ds</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y, z, w</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g x = g y</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">in_same_set g x y = <span class="nb">left</span> x0</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">In_Same_Set (union g z w) x y</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">   </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="unionfind-v-chk56" style="display: none" type="checkbox"><label class="alectryon-input" for="unionfind-v-chk56"><span class="highlight"><span class="nb">unfold</span> union, In_Same_Set.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ds</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y, z, w</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g x = g y</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">in_same_set g x y = <span class="nb">left</span> x0</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">exists</span>
  <span class="nv">p</span> : (<span class="kr">if</span> Nat.eq_dec (find_root g z) (find_root g x)
       <span class="kr">then</span> find_root g w
       <span class="kr">else</span> find_root g x) =
      (<span class="kr">if</span> Nat.eq_dec (find_root g z) (find_root g y)
       <span class="kr">then</span> find_root g w
       <span class="kr">else</span> find_root g y),
  in_same_set
    (<span class="kr">fun</span> <span class="nv">z0</span> : nat =&gt;
     <span class="kr">if</span> Nat.eq_dec (find_root g z) (find_root g z0)
     <span class="kr">then</span> find_root g w
     <span class="kr">else</span> find_root g z0) x y = <span class="nb">left</span> p</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">   </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="unionfind-v-chk57" style="display: none" type="checkbox"><label class="alectryon-input" for="unionfind-v-chk57"><span class="highlight"><span class="nb">unfold</span> in_same_set <span class="kr">in</span> H.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ds</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y, z, w</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g x = g y</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Nat.eq_dec (g x) (g y) = <span class="nb">left</span> x0</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">exists</span>
  <span class="nv">p</span> : (<span class="kr">if</span> Nat.eq_dec (find_root g z) (find_root g x)
       <span class="kr">then</span> find_root g w
       <span class="kr">else</span> find_root g x) =
      (<span class="kr">if</span> Nat.eq_dec (find_root g z) (find_root g y)
       <span class="kr">then</span> find_root g w
       <span class="kr">else</span> find_root g y),
  in_same_set
    (<span class="kr">fun</span> <span class="nv">z0</span> : nat =&gt;
     <span class="kr">if</span> Nat.eq_dec (find_root g z) (find_root g z0)
     <span class="kr">then</span> find_root g w
     <span class="kr">else</span> find_root g z0) x y = <span class="nb">left</span> p</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">   </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="unionfind-v-chk58" style="display: none" type="checkbox"><label class="alectryon-input" for="unionfind-v-chk58"><span class="highlight"><span class="nb">unfold</span> in_same_set.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ds</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y, z, w</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g x = g y</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Nat.eq_dec (g x) (g y) = <span class="nb">left</span> x0</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">exists</span>
  <span class="nv">p</span> : (<span class="kr">if</span> Nat.eq_dec (find_root g z) (find_root g x)
       <span class="kr">then</span> find_root g w
       <span class="kr">else</span> find_root g x) =
      (<span class="kr">if</span> Nat.eq_dec (find_root g z) (find_root g y)
       <span class="kr">then</span> find_root g w
       <span class="kr">else</span> find_root g y),
  Nat.eq_dec
    (<span class="kr">if</span> Nat.eq_dec (find_root g z) (find_root g x)
     <span class="kr">then</span> find_root g w
     <span class="kr">else</span> find_root g x)
    (<span class="kr">if</span> Nat.eq_dec (find_root g z) (find_root g y)
     <span class="kr">then</span> find_root g w
     <span class="kr">else</span> find_root g y) = <span class="nb">left</span> p</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">   </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="unionfind-v-chk59" style="display: none" type="checkbox"><label class="alectryon-input" for="unionfind-v-chk59"><span class="highlight"><span class="nb">unfold</span> find_root.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ds</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y, z, w</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g x = g y</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Nat.eq_dec (g x) (g y) = <span class="nb">left</span> x0</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">exists</span>
  <span class="nv">p</span> : (<span class="kr">if</span> Nat.eq_dec (g z) (g x) <span class="kr">then</span> g w <span class="kr">else</span> g x) =
      (<span class="kr">if</span> Nat.eq_dec (g z) (g y) <span class="kr">then</span> g w <span class="kr">else</span> g y),
  Nat.eq_dec
    (<span class="kr">if</span> Nat.eq_dec (g z) (g x) <span class="kr">then</span> g w <span class="kr">else</span> g x)
    (<span class="kr">if</span> Nat.eq_dec (g z) (g y) <span class="kr">then</span> g w <span class="kr">else</span> g y) =
  <span class="nb">left</span> p</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">   </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="unionfind-v-chk5a" style="display: none" type="checkbox"><label class="alectryon-input" for="unionfind-v-chk5a"><span class="highlight"><span class="nb">rewrite</span> x0.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ds</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y, z, w</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g x = g y</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Nat.eq_dec (g x) (g y) = <span class="nb">left</span> x0</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">exists</span>
  <span class="nv">p</span> : (<span class="kr">if</span> Nat.eq_dec (g z) (g y) <span class="kr">then</span> g w <span class="kr">else</span> g y) =
      (<span class="kr">if</span> Nat.eq_dec (g z) (g y) <span class="kr">then</span> g w <span class="kr">else</span> g y),
  Nat.eq_dec
    (<span class="kr">if</span> Nat.eq_dec (g z) (g y) <span class="kr">then</span> g w <span class="kr">else</span> g y)
    (<span class="kr">if</span> Nat.eq_dec (g z) (g y) <span class="kr">then</span> g w <span class="kr">else</span> g y) =
  <span class="nb">left</span> p</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">   </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">apply</span> nat_eq_refl.</span></span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span></span></pre><p>Here's a small enhancement. We can define a new version of union that checks if the two elements being unioned are already in the same set.</p>
<pre class="alectryon-io"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">union2</span> (<span class="nv">g</span> : ds) <span class="nv">x</span> <span class="nv">y</span> : ds :=
        <span class="kr">let</span> <span class="nv">px</span> := find_root g x <span class="kr">in</span>
        <span class="kr">let</span> <span class="nv">py</span> := find_root g y <span class="kr">in</span>
        <span class="kr">if</span> Nat.eq_dec px py <span class="kr">then</span>
            g
        <span class="kr">else</span>
        <span class="kr">fun</span> <span class="nv">z</span> =&gt;
        <span class="kr">let</span> <span class="nv">pz</span> := find_root g z <span class="kr">in</span>
        <span class="kr">if</span> Nat.eq_dec px pz
        <span class="kr">then</span> py
        <span class="kr">else</span> pz.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="unionfind-v-chk5b" style="display: none" type="checkbox"><label class="alectryon-input" for="unionfind-v-chk5b"><span class="highlight"><span class="kn">Check</span> in_same_set.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-messages"><blockquote class="alectryon-message"><span class="highlight">in_same_set
     : <span class="kr">forall</span> (<span class="nv">g</span> : ds) (<span class="nv">x</span> <span class="nv">y</span> : nat),
       {g x = g y} + {g x &lt;&gt; g y}</span></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">

</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="unionfind-v-chk5c" style="display: none" type="checkbox"><label class="alectryon-input" for="unionfind-v-chk5c"><span class="highlight"><span class="kn">Theorem</span> <span class="nf">union2_correct</span> : <span class="kr">forall</span> <span class="nv">g</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span>, 
          (union2 g x y) z = (union g x y) z.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">g</span> : ds) (<span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span> : nat),
union2 g x y z = union g x y z</span></div></blockquote></div></div></small><span class="alectryon-wsp"> 
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="unionfind-v-chk5d" style="display: none" type="checkbox"><label class="alectryon-input" for="unionfind-v-chk5d"><span class="highlight"><span class="nb">intros</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ds</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y, z</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">union2 g x y z = union g x y z</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="unionfind-v-chk5e" style="display: none" type="checkbox"><label class="alectryon-input" for="unionfind-v-chk5e"><span class="highlight"><span class="nb">unfold</span> union, union2, find_root.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ds</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y, z</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(<span class="kr">if</span> Nat.eq_dec (g x) (g y)
 <span class="kr">then</span> g
 <span class="kr">else</span>
  <span class="kr">fun</span> <span class="nv">z</span> : nat =&gt;
  <span class="kr">if</span> Nat.eq_dec (g x) (g z) <span class="kr">then</span> g y <span class="kr">else</span> g z) z =
(<span class="kr">if</span> Nat.eq_dec (g x) (g z) <span class="kr">then</span> g y <span class="kr">else</span> g z)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">destruct</span> (Nat.eq_dec (g x) (g y)) <span class="nb">eqn</span>:E2;
    <span class="nb">destruct</span> (Nat.eq_dec (g x) (g z)) <span class="nb">eqn</span>:E1;
    <span class="bp">congruence</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span></span></pre></div>
<div class="section" id="possible-refinements">
<h1>Possible Refinements</h1>
<p>You could abstract over the things that you're forming disjoint sets over
This means you need an enumeration to define init_ds</p>
<pre class="alectryon-io"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">ds&#39;</span> (<span class="nv">a</span> : <span class="kt">Type</span>) := a -&gt; nat.</span></span></span></pre><p>Or you can use a self map. This requires decidable equality in for checking canonical elements in the codomain</p>
<pre class="alectryon-io"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">ds&#39;&#39;</span> (<span class="nv">a</span> : <span class="kt">Type</span>) := a -&gt; a.</span></span></span></pre><p>Or you could do a fun proof relevant version for equivalence relations <code class="highlight coq"><span class="name">R</span></code>. Now to perform a union you'll need to supply a proof <code class="highlight coq"><span class="name">R</span> <span class="name">x</span> <span class="name">y</span></code></p>
<pre class="alectryon-io"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">ds_pf</span> (<span class="nv">a</span> : <span class="kt">Type</span>) (<span class="nv">R</span> : a -&gt; a -&gt; <span class="kt">Prop</span>) := 
    <span class="kr">forall</span> <span class="nv">x</span> : a,  {y : a | R x y}.</span></span></span></pre><p>Another possibility is to use the fairly new feature of Coq, persistent arrays</p>
<ul class="simple">
<li><a class="reference external" href="https://coq.inria.fr/refman/language/core/primitive.html#primitive-arrays">https://coq.inria.fr/refman/language/core/primitive.html#primitive-arrays</a></li>
<li><a class="reference external" href="https://coq.github.io/doc/master/stdlib/Coq.Array.PArray.html">https://coq.github.io/doc/master/stdlib/Coq.Array.PArray.html</a></li>
</ul>
<p>This may indeed why these were added. They do require dealing with termination though. Here's one suggestion of an encoding. I dunno if this will bite you in the butt.</p>
<pre class="alectryon-io"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Require Import</span> PArray.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Open Scope</span> array_scope.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Fixpoint</span> <span class="nf">find_root&#39;</span> <span class="nv">gas</span> (<span class="nv">a</span> : array (sum nat Int63.int)) 
         (<span class="nv">i</span> : Int63.int) :=
    <span class="kr">match</span> gas <span class="kr">with</span>
    | O =&gt; None
    | S gas&#39; =&gt; <span class="kr">match</span> a .[i] <span class="kr">with</span>
        | inl x =&gt; Some i
        | inr j =&gt; find_root&#39; gas&#39; a j
    <span class="kr">end</span>
    <span class="kr">end</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Record</span> <span class="nf">disjoint_set</span> := {
    gas : nat; <span class="c">(* unions, or height *)</span>
    parents  : array (sum nat Int63.int) ;
    term_pf : <span class="kr">forall</span> <span class="nv">i</span>, <span class="kr">exists</span> <span class="nv">n</span>, 
              (find_root&#39; gas parents i = Some n)
}.</span></span></span></pre></div>

Built using Alectryon <https://github.com/cpitclaudel/alectryon>

A stack overflow question <https://stackoverflow.com/questions/66630519/how-to-implement-a-union-find-disjoint-set-data-structure-in-coq/66875872#66875872>